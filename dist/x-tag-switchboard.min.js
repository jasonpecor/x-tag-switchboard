xtag.mixins.switchboard=function(){"use strict";function e(e,t){n[e]||(n[e]=[]),-1===n[e].indexOf(t)&&n[e].push(t)}function t(e,t){if(!n[e])return!1;var r=n[e].indexOf(t);return-1===r?!1:(n[e].splice(r,1),!0)}var n={},r=!0,s=!1,i={patch:function(e,t,n){if("object"==typeof e){if(e instanceof HTMLElement){if(e._patches||Object.defineProperty(e,"_patches",{value:[],enumerable:!1}),"string"==typeof t)e._patches.push(t);else{if(!(t instanceof Array))throw new TypeError("Cannot patch event: Must be string or array of strings");e._patches=e._patches.concat(t)}return e}if(e._patches||Object.defineProperties(e,{_listeners:{value:{},enumerable:!1,writable:!0},_patches:{value:[],enumerable:!1,writable:!0},addEventListener:{value:function(e,t,n){this._listeners[e]||(this._listeners[e]=[]),this._listeners[e].push(t)}},removeEventListener:{value:function(e,t,n){if(this.listeners[e])if(e||t)if(t){var r=this.listeners[e].indexOf(t);if(-1===r)return;this.listeners[e].splice(r,1)}else this.listeners[e]=[];else this.listeners={}}},dispatchEvent:{value:function(e){var t=e.type;if(this._listeners[t])for(var n=this._listeners[t].length,r=0;n>r;r++)this._listeners[t][r].call(this,e)}},tagName:{value:n?"+ "+n:"+ proxy-object"},__proxy:{value:!0}}),"string"==typeof t)e._patches.push(t);else{if(!(t instanceof Array))throw new TypeError("Cannot patch event: Must be string or array of strings");e._patches=e._patches.concat(t)}return e}},connect:function(t){if(t._patches)for(var n=t._patches.length,r=0;n>r;r++)e(t._patches[r],t)},disconnect:function(e){if(e._patches)for(var n=e._patches.length,r=0;n>r;r++)t(e._patches[r],e)},unpatch:function(e,n){if(n){if(n instanceof Array)for(var r=n.length,s=0;r>s;s++){var a=e._patches.indexOf(n[s]);-1!==a&&(e._patches.splice(a,1),(e.parentNode||e.__proxy)&&t(n[s],e))}else if("string"==typeof n){var a=e._patches.indexOf(n);-1!==a&&(e._patches.splice(a,1),(e.parentNode||e.__proxy)&&t(n,e))}}else(e.parentNode||e.__proxy)&&i.disconnect(e),e._patches=[]},transmit:function(e,t){if(!r)return 0;if(!n[e])return 0;var i=n[e].length;s&&console.log("switchboard -> %s connections",i,n[e]),t=t||{},"undefined"==typeof t.bubbles&&(t.bubbles=!1);for(var a=0;i>a;a++)xtag.fireEvent(n[e][a],e,t);return i},get online(){return r},set online(e){r=!!e},get connections(){return n},showConnections:function(){if(console.table){var e=[["Event Name","Element"],[]];for(var t in n)if(n.hasOwnProperty(t))for(var r=n[t],s=r.length,i=0;s>i;i++)e.push([t,"<"+r[i].tagName.toLowerCase()+">"]);console.table(e)}},get debug(){return s},set debug(e){s=!!e}};xtag.switchboard=i;var a={lifecycle:{created:function(){Object.defineProperty(this,"switchboard",{value:i,writable:!1,enumerable:!1}),Object.defineProperty(this,"_patches",{value:[],enumerable:!1,writable:!0})},inserted:function(){this.switchboard.connect(this)},removed:function(){this.switchboard.disconnect(this)}}};return a}();